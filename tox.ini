[tox]
envlist = py311,lint,security
requires = tox-conda

[testenv]
deps = 
    -rrequirements.txt
    pytest
    pytest-cov
    pytest-asyncio
commands = 
    pytest {posargs}

[testenv:lint]
deps = 
    black
    ruff
    mypy
commands = 
    black --check fdp tests
    ruff check fdp tests
    mypy --strict fdp

[testenv:security]
deps = 
    bandit
    safety
commands = 
    bandit -r fdp -f json -o reports/security.json
    safety check --json --output reports/safety.json

[testenv:docs]
deps = 
    sphinx
    sphinx-book-theme
    myst-parser
commands = 
    sphinx-build -W -b html docs/ docs/_build/html

[flake8]
max-line-length = 100
exclude = .git,__pycache__,docs,build,dist,.tox,.venv
ignore = E203,W503

[coverage:run]
source = fdp
omit = 
    */tests/*
    */test_*
    */site-packages/*
    */__init__.py

[coverage:report]
precision = 2
show_missing = True
skip_covered = False
fail_under = 70
